<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Causal Inference: Introduction</title>

        <link rel="stylesheet" href="dist/reset.css">
        <link rel="stylesheet" href="dist/reveal.css">
        <link rel="stylesheet" href="dist/theme/white.css" id="theme">

        <!-- Theme used for syntax highlighted code -->
        <link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1>Causal Inference: Introduction</h1>
                    <p>
                        &copy; 2020 Anton Lebedevich
                    </p>
                </section>
                <section>
                    <h2>Anton Lebedevich</h2>
                    <ul>
                        <li>data science engineer</li>
                        <li>background in backend performance optimization</li>
                        <li>loves time series and anomalies</li>
                        <li>worked on spam detection, marketing campaign optimization, demand forecasting</li>
                        <li>blogs at <a href="http://mabrek.github.io">mabrek.github.io</a>
                    </ul>
                </section>
                <section>
                    <h2>Outline</h2>
                    TODO
                </section>
                <section>
                    <h2>Story: Dog's Tail</h2>
                    <img  class="stretch" src="img/chris-arthur-collins-wosoGykZdBg-unsplash.jpg"/>
                    <p style="font-size: 20px; font-style: italic;">Photo by <a href="https://unsplash.com/@anotherleaf?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Chris Arthur-Collins</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
                </section>
                <section>
                    <h2>ML problem: make a dog friendly</h2>
                    <img class="stretch" src="img/jana-sabeth-G_ykOgaAzKs-unsplash.jpg"/>
                    <p style="font-size: 20px; font-style: italic;">Photo by <a href="https://unsplash.com/@janasabeth?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Jana Sabeth</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
                </section>
                <section>
                    <h2>Dogs Dataset</h2>
                    <table>
                        <tr>
                            <th>breed</th>
                            <th>size</th>
                            <th>tail wagging</th>
                            <th>&hellip;</th>
                            <th>friendly</th>
                        </tr>
                        <tr>
                            <td>pug</td>
                            <td>small</td>
                            <td>yes</td>
                            <td></td>
                            <td>yes</td>
                        </tr>
                        <tr>
                            <td>doberman</td>
                            <td>big</td>
                            <td>yes</td>
                            <td></td>
                            <td>yes</td>
                        </tr>
                        <tr>
                            <td>chihuahua</td>
                            <td>small</td>
                            <td>no</td>
                            <td></td>
                            <td>no</td>
                        </tr>
                        <tr>
                            <td>&hellip;</td>
                        </tr>
                    </table>
                </section>
                <section>
                    <h2>tail wagging &rarr; friendliness</h2>
                </section>
                <section>
                    <h2>you decided to wag his tail</h2>
                    <img class="stretch" src="img/no-you-sit.jpg"/>
                    <p style="font-size: 20px; font-style: italic;">By <a rel="nofollow" class="external text" href="https://www.flickr.com/people/52485003@N00">Roberto Ferrari</a> from Campogalliano (Modena), Italy - <a rel="nofollow" class="external text" href="https://www.flickr.com/photos/roberto_ferrari/3274411925/">Dog</a>, <a href="https://creativecommons.org/licenses/by-sa/2.0" title="Creative Commons Attribution-Share Alike 2.0">CC BY-SA 2.0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=26291061">Link</a></p>
                </section>
                <section>
                    <h2>YOU DIED</h2>
                </section>
                <section>
                    <h2>Story: Sales Before Weekend</h2>
                    <img class="stretch" src="img/nrd-D6Tu_L3chLE-unsplash.jpg"/>
                    <p style="font-size: 20px; font-style: italic;">Photo by <a href="https://unsplash.com/@nicotitto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">nrd</a> on <a href="https://unsplash.com/s/photos/grocery?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
                </section>
                <section>
                    <h2>Product Weekly Sales</h2>
                    <img class="stretch" src="img/weekly sales.svg"/>
                </section>
                <section>
                    <h2>ML Problem: Optimize Replenishment</h2>
                    <img class="stretch" src="img/1280px-ISUZU_GIGAMAX,_Semi-Trailer.jpg"/>
                    <p style="font-size: 20px; font-style: italic;"><a href="https://commons.wikimedia.org/wiki/File:ISUZU_GIGAMAX,_Semi-Trailer.jpg" title="via Wikimedia Commons">Mj-bird</a> / <a href="https://creativecommons.org/licenses/by-sa/3.0">CC BY-SA</a></p>
                </section>
                <section>
                    <ul>
                        <li>usually truck arrives on Monday noon</li>
                        <li>model predicts low sales on Fri-Sun despite having some items in stock</li>
                        <li>you decide to send one truck on Monday evening</li>
                        <li>&hellip;</li>
                        <li>NO PROFIT, Monday sales dropped</li>
                        <li>the product expires in one week, so ppl don't want to stockpile soon to be expired product for weekend</li>
                    </ul>
                </section>
                <section>
                    <h2>better to send two trucks</h2>
                    <img class="stretch" src="img/weekly sales two trucks.svg"/>
                </section>
                <section>
                    <p>typical ML introduction courses be like:</p>
                    <h2>problem &rarr; ML &rarr; solution</h2>
                    <img class="stretch" src="img/futurama-fry-not-sure-if.png"/>
                    <p style="font-size: 20px; font-style: italic;">source <a href="https://knowyourmeme.com/memes/futurama-fry-not-sure-if">knowyourmeme.com/memes/futurama-fry-not-sure-if</a></p>
                </section>
                <section>
                    <h2>Causation</h2>
                    <p>there is something that you can't figure out from historical data alone</p>
                    <p>you need to have domain knowledge or run experiments</p>
                    <p>kids learn that hard way (have you tried to wag dog's tail?)</p>
                </section>
                <section>
                    <h2>Causal questions</h2>
                    <ul>
                        <li>Estimating the treatment effect on a population</li>
                        <li>Which treatment to choose for a patient?</li>
                        <li>How many items will be sold if we set price to X?</li>
                        <li>How much money your model deployment could bring?</li>
                        <li>Does X cause Y?</li>
                        <li>What if &hellip;?</li>
                    </ul>
                </section>
                <section>
                    <h2>And the most important question:</h2>
                    <p>Will this dog be happy if we pet it?</p>
                    <img class="stretch" src="img/toshi-lySzv_cqxH8-unsplash.jpg"\>
                    <p style="font-size: 20px; font-style: italic;">Photo by <a href="https://unsplash.com/@toshilepug?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Toshi</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
                </section>
                <section>
                    <h2>It's not a Typical Supervised ML Problem</h2>
                </section>
                <section>
                    <h2>Correlation does not imply causation</h2>
                    <blockquote>inability to legitimately deduce a cause-and-effect relationship between two variables solely on the basis of an observed association or correlation between them</blockquote>
                    <p style="font-size: 20px; font-style: italic;"><a href="https://en.wikipedia.org/wiki/Correlation_does_not_imply_causation">en.wikipedia.org/wiki/Correlation_does_not_imply_causation</a></p>
                    <p>supervised ml models learn association (correlation) not causation (effect of intervention)</p>
                    <img class="stretch" src="img/2011-01-09-Nuthin's-Funnier.jpg"/>
                    <p style="font-size: 20px; font-style: italic;">source <a href="http://completelyseriouscomics.com/?p=16">completelyseriouscomics.com/?p=16</a>
                </section>
                <section>
                    <h2>Causation vs Association</h2>
                    <img class="stretch" src="img/figure1.1.png"/>
                    <p style="font-size: 20px; font-style: italic;">source <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">Hernán MA, Robins JM (2020). Causal Inference: What If. Boca Raton: Chapman &amp; Hall/CRC.</a>
                </section>
                <section>
                    <table>
                        <tr>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <img src="img/2020-fest-bl-c.png"/>
                            </td>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <p>AB-tests</p>
                                <ul>
                                    <li>randomization of treatment breaks hidden dependencies</li>
                                    <li>TODO</li>
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <img src="img/2020-fest-tl-c.png"/>
                            </td>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <p>Observational Studies</p>
                                <ul>
                                    <li>causal structure is assumed, not tested by intervention</li>
                                    <li>hidden dependencies introduce bias</li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </section>
                <section>
                    <table>
                        <tr>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <img src="img/2020-fest-tl-c.png"/>
                            </td>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <p>AB-tests</p>
                                <ul>
                                    <li>difficult to make double blind surgery</li>
                                    <li>non-adherence in clinical trials</li>
                                    <li>small sizes, limited geography</li>
                                    <li>too long or expensive</li>
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <img src="img/2020-fest-bl-c.png"/>
                            </td>
                            <td style="text-align: center; border-bottom: none; vertical-align: middle;">
                                <p>Observational Studies</p>
                                <ul>
                                    <li>you can use historical data</li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </section>
                <section>
                    <h2>Observational Studies</h2>
                    <p>use only if you can't run randomized experiment</p>
                    <ul>
                        <li>you have to make assumptions</li>
                        <li>requires exchangeability, positivity, consistency</li>
                        <li>breaks under unmeasured confounding</li>
                    </ul>
                </section>
                <section>
                    <h2>Exchangeability</h2>
                    <blockquote>The conditional probability of receiving every value of treatment, though not decided by the investigators, depends only on measured covariates</blockquote>
                </section>
                <section>
                    <h2>Positivity</h2>
                    <blockquote>The probability of receiving every value of treatment conditional on covariates is positive.</blockquote>
                </section>
                <section>
                    <h2>Consistency</h2>
                    <blockquote>The values of treatment under comparison correspond to well-defined interventions that, in turn, correspond to the versions of treatment in the data </blockquote>
                    story: being fit by genes and exercising vs. being obese and forced to diet and exercise
                </section>
                <section>
                    <h2>Causal Diagrams</h2>
                    <p>TODO image structure of confounding, with and without conditioning
                    <p>relation to PGM
                </section>
                <section>
                    <h2>Complicated Bias (M-shaped)</h2>
                    <p>TODO physical activity and cervical cancer image from What If book
                </section>
                <section>
                    <h2>Selection Bias</h2>
                    TODO image
                </section>
                <section>
                    <h2>Measurement Bias</h2>
                    TODO image
                </section>
                <section>
                    <h2>Methods</h2>
                    <ul>
                        <li>stratification</li>
                        <li>propensity scores (many ways to use)</li>
                        <li>outcome regression (is my profession)</li>
                        <li>&hellip; to be continued, active research</li>
                    </ul>
                </section>
                <section>
                    <h2>G-estimation (if time allows)</h2>
                    stratification, matching, conditioning doesn't work for complex structure from "An introduction to g methods"
                </section>
                <section>
                    <h2>Moar Layers and Moar Data Myth</h2>
                    <ul>
                        <li>adding features could add more bias (from variable selection What If Book)</li>
                        <li>more data doesn't mean that extra data is unbiased</li>
                        <li>ml model could throw away your treatment variable</li>
                        <li>confounders are correlated with causes, incorrect feature importance</li>
                        <li>regression coefficients are unstable for correlated features</li>
                        <li>still can't find causation, only association</li>
                    </ul>
                </section>
                <section>
                    <h2>Be careful</h2>
                    observational studies have shown to make more mistakes when someone tries to reproduce<br/>
                    TODO link to slide from MS presentation on reproducibility of observational studies
                </section>
                <section>
                    <h2>Links</h2>
                    What If book https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/

                    An introduction to g methods https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6074945/

                    Judea Pearl, Causal inference in statistics: An overview http://ftp.cs.ucla.edu/pub/stat_ser/r350.pdf

                    The Book of Why: The New Science of Cause - Judea Pearl

                    https://causalinference.gitlab.io/kdd-tutorial/

                    Causal Inference Seminar - Peter Tennant-SbrX3YEMj_0.mp4

                    Causal Inference in Online Systems-7ebafe1f-8af3-46a2-8308-a909014772c0.mp4
                </section>
                <section>
                    <h2>Q&amp;A</h2>
                    <p>
                    <p>Anton Lebedevich</p>
                    <p>mabrek@gmail.com</p>
                    <p><img src="img/Twitter_Logo_Blue.svg" height="25" width="25" style="margin: 0px 0px;"/><a href="https://twitter.com/widdoc">@widdoc</a></p>
                    <p><a href="https://mabrek.github.io/causal-inference-2020/">mabrek.github.io/causal-inference-2020/</a></p>
                </section>
            </div>
        </div>

        <script src="dist/reveal.js"></script>
        <script src="plugin/notes/notes.js"></script>
        <script src="plugin/markdown/markdown.js"></script>
        <script src="plugin/highlight/highlight.js"></script>
        <script>
            // More info about initialization & config:
            // - https://revealjs.com/initialization/
            // - https://revealjs.com/config/
            Reveal.initialize({
              hash: true,
              controls: false,
              progress: false,
              history: true,
              center: true,
              slideNumber: 'c/t',
              transition: 'none',
              width: 1920,
              height: 1080,
              // Learn about plugins: https://revealjs.com/plugins/
              plugins: [ RevealHighlight, RevealNotes ]
            });
        </script>
    </body>
</html>
